<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liquidity Pool Platform</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <style>
        :root {
            --primary-color: #6a11cb;
            --secondary-color: #2575fc;
            --background-color: #121212;
            --surface-color: #1e1e1e;
            --surface-light: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --error-color: #f44336;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--background-color);
            color: var(--text-primary);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.2rem;
        }
        
        .card {
            background-color: var(--surface-color);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .wallet-section {
            text-align: center;
        }
        
        .btn {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            display: inline-block;
            margin: 10px 5px;
        }
        
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(106, 17, 203, 0.4);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #2e7d32);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color), #e65100);
        }
        
        .input-group {
            margin: 20px 0;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }
        
        .input-group input {
            width: 100%;
            padding: 12px;
            background-color: var(--surface-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            color: var(--text-primary);
            font-size: 1rem;
        }
        
        .wallet-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--surface-light);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .wallet-address {
            font-family: monospace;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 70%;
        }
        
        .balance-info {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            padding: 10px;
            background-color: var(--surface-light);
            border-radius: 5px;
        }
        
        .countdown {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--warning-color);
            text-align: center;
            margin: 15px 0;
        }
        
        .investment-item {
            background-color: var(--surface-light);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .investment-details {
            flex: 1;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .status-active {
            background-color: rgba(255, 152, 0, 0.2);
            color: var(--warning-color);
        }
        
        .status-completed {
            background-color: rgba(76, 175, 80, 0.2);
            color: var(--success-color);
        }
        
        .hidden {
            display: none;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 5px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            max-width: 300px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .notification.success {
            background-color: var(--success-color);
        }
        
        .notification.error {
            background-color: var(--error-color);
        }
        
        .notification.info {
            background-color: var(--secondary-color);
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: var(--surface-light);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .stat-label {
            color: var(--text-secondary);
            margin-top: 5px;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: var(--text-secondary);
            margin-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .investment-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .wallet-info {
                flex-direction: column;
                gap: 10px;
            }
            
            .wallet-address {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Liquidity Pool Platform</h1>
            <p class="subtitle">Investimento em USDT com retorno garantido de 24% em 28 dias</p>
        </header>
        
        <div id="notification-container"></div>
        
        <div class="card wallet-section">
            <h2>Conectar Carteira</h2>
            <p>Conecte sua carteira MetaMask ou compatível para começar a investir</p>
            <button id="connect-wallet-btn" class="btn">Conectar Carteira</button>
            <div id="wallet-info" class="wallet-info hidden">
                <div class="wallet-address" id="wallet-address"></div>
                <button id="disconnect-btn" class="btn">Desconectar</button>
            </div>
        </div>
        
        <div id="invest-section" class="card hidden">
            <h2>Investir USDT</h2>
            <div class="balance-info">
                <span>Saldo de USDT:</span>
                <span id="usdt-balance">0</span>
            </div>
            <div class="input-group">
                <label for="invest-amount">Valor do Investimento (USDT):</label>
                <input type="number" id="invest-amount" placeholder="Digite o valor em USDT" min="0" step="0.01">
            </div>
            <div class="balance-info">
                <span>Taxa (2%):</span>
                <span id="fee-amount">0</span>
            </div>
            <div class="balance-info">
                <span>Valor a ser investido:</span>
                <span id="principal-amount">0</span>
            </div>
            <button id="invest-btn" class="btn">Investir</button>
        </div>
        
        <div id="investments-section" class="card hidden">
            <h2>Meus Investimentos</h2>
            <div id="investments-list"></div>
        </div>
        
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-value" id="total-invested">0</div>
                <div class="stat-label">Total Investido (USDT)</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="total-earned">0</div>
                <div class="stat-label">Total Recebido (USDT)</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="active-investments">0</div>
                <div class="stat-label">Investimentos Ativos</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="completed-investments">0</div>
                <div class="stat-label">Investimentos Concluídos</div>
            </div>
        </div>
        
        <footer>
            <p>© 2023 Liquidity Pool Platform. Todos os direitos reservados.</p>
            <p>Contrato: 0x888E1b705d8E380146a9CE1f62b23F3D905a6121</p>
        </footer>
    </div>

    <script>
        // ABI do contrato
        const contractABI = [
            {
                "inputs": [],
                "stateMutability": "nonpayable",
                "type": "constructor"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "owner",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "spender",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "value",
                        "type": "uint256"
                    }
                ],
                "name": "Approval",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "dev",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "FeeTransferred",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "investor",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "uint256",
                        "name": "investmentId",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "Invested",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "previousOwner",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "newOwner",
                        "type": "address"
                    }
                ],
                "name": "OwnershipTransferred",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "from",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "to",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "value",
                        "type": "uint256"
                    }
                ],
                "name": "Transfer",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "investor",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "uint256",
                        "name": "investmentId",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "Withdrawn",
                "type": "event"
            },
            {
                "inputs": [],
                "name": "BITNEST",
                "outputs": [
                    {
                        "internalType": "contract IBitNest",
                        "name": "",
                        "type": "address"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "DEV_WALLET",
                "outputs": [
                    {
                        "internalType": "address",
                        "name": "",
                        "type": "address"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "FEE_PERCENT",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "INVESTMENT_PERIOD",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "RETURN_PERCENT",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "USDT",
                "outputs": [
                    {
                        "internalType": "contract IERC20",
                        "name": "",
                        "type": "address"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "investmentId",
                        "type": "uint256"
                    }
                ],
                "name": "getInvestmentById",
                "outputs": [
                    {
                        "components": [
                            {
                                "internalType": "uint256",
                                "name": "id",
                                "type": "uint256"
                            },
                            {
                                "internalType": "address",
                                "name": "investor",
                                "type": "address"
                            },
                            {
                                "internalType": "uint256",
                                "name": "principalAmount",
                                "type": "uint256"
                            },
                            {
                                "internalType": "uint256",
                                "name": "originalAmount",
                                "type": "uint256"
                            },
                            {
                                "internalType": "uint256",
                                "name": "timestamp",
                                "type": "uint256"
                            },
                            {
                                "internalType": "bool",
                                "name": "withdrawn",
                                "type": "bool"
                            }
                        ],
                        "internalType": "struct InvestmentProxy.Investment",
                        "name": "",
                        "type": "tuple"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "investmentId",
                        "type": "uint256"
                    }
                ],
                "name": "getTimeUntilWithdrawal",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "investor",
                        "type": "address"
                    }
                ],
                "name": "getInvestmentCount",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "investor",
                        "type": "address"
                    }
                ],
                "name": "getInvestments",
                "outputs": [
                    {
                        "components": [
                            {
                                "internalType": "uint256",
                                "name": "id",
                                "type": "uint256"
                            },
                            {
                                "internalType": "address",
                                "name": "investor",
                                "type": "address"
                            },
                            {
                                "internalType": "uint256",
                                "name": "principalAmount",
                                "type": "uint256"
                            },
                            {
                                "internalType": "uint256",
                                "name": "originalAmount",
                                "type": "uint256"
                            },
                            {
                                "internalType": "uint256",
                                "name": "timestamp",
                                "type": "uint256"
                            },
                            {
                                "internalType": "bool",
                                "name": "withdrawn",
                                "type": "bool"
                            }
                        ],
                        "internalType": "struct InvestmentProxy.Investment[]",
                        "name": "",
                        "type": "tuple[]"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "invest",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "investmentCounter",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "owner",
                "outputs": [
                    {
                        "internalType": "address",
                        "name": "",
                        "type": "address"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "newOwner",
                        "type": "address"
                    }
                ],
                "name": "transferOwnership",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "investmentId",
                        "type": "uint256"
                    }
                ],
                "name": "withdraw",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            }
        ];

        // Endereço do contrato
        const contractAddress = "0x888E1b705d8E380146a9CE1f62b23F3D905a6121";
        
        // Endereço do USDT na BSC
        const usdtAddress = "0x55d398326f99059fF775485246999027B3197955";
        
        // ABI do USDT
        const usdtABI = [
            {
                "constant": true,
                "inputs": [],
                "name": "name",
                "outputs": [
                    {
                        "name": "",
                        "type": "string"
                    }
                ],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [],
                "name": "symbol",
                "outputs": [
                    {
                        "name": "",
                        "type": "string"
                    }
                ],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [],
                "name": "decimals",
                "outputs": [
                    {
                        "name": "",
                        "type": "uint8"
                    }
                ],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [
                    {
                        "name": "_owner",
                        "type": "address"
                    }
                ],
                "name": "balanceOf",
                "outputs": [
                    {
                        "name": "balance",
                        "type": "uint256"
                    }
                ],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [],
                "name": "totalSupply",
                "outputs": [
                    {
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_to",
                        "type": "address"
                    },
                    {
                        "name": "_value",
                        "type": "uint256"
                    }
                ],
                "name": "transfer",
                "outputs": [
                    {
                        "name": "",
                        "type": "bool"
                    }
                ],
                "payable": false,
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_from",
                        "type": "address"
                    },
                    {
                        "name": "_to",
                        "type": "address"
                    },
                    {
                        "name": "_value",
                        "type": "uint256"
                    }
                ],
                "name": "transferFrom",
                "outputs": [
                    {
                        "name": "",
                        "type": "bool"
                    }
                ],
                "payable": false,
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [
                    {
                        "name": "_spender",
                        "type": "address"
                    },
                    {
                        "name": "_value",
                        "type": "uint256"
                    }
                ],
                "name": "approve",
                "outputs": [
                    {
                        "name": "",
                        "type": "bool"
                    }
                ],
                "payable": false,
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [
                    {
                        "name": "_owner",
                        "type": "address"
                    },
                    {
                        "name": "_spender",
                        "type": "address"
                    }
                ],
                "name": "allowance",
                "outputs": [
                    {
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "name": "from",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "name": "to",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "name": "value",
                        "type": "uint256"
                    }
                ],
                "name": "Transfer",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "name": "owner",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "name": "spender",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "name": "value",
                        "type": "uint256"
                    }
                ],
                "name": "Approval",
                "type": "event"
            }
        ];
        
        // Variáveis globais
        let provider;
        let signer;
        let contract;
        let usdtContract;
        let account;
        let investments = [];
        
        // Elementos do DOM
        const connectWalletBtn = document.getElementById('connect-wallet-btn');
        const disconnectBtn = document.getElementById('disconnect-btn');
        const walletInfo = document.getElementById('wallet-info');
        const walletAddress = document.getElementById('wallet-address');
        const investSection = document.getElementById('invest-section');
        const investmentsSection = document.getElementById('investments-section');
        const investAmountInput = document.getElementById('invest-amount');
        const investBtn = document.getElementById('invest-btn');
        const usdtBalance = document.getElementById('usdt-balance');
        const feeAmount = document.getElementById('fee-amount');
        const principalAmount = document.getElementById('principal-amount');
        const investmentsList = document.getElementById('investments-list');
        const totalInvested = document.getElementById('total-invested');
        const totalEarned = document.getElementById('total-earned');
        const activeInvestments = document.getElementById('active-investments');
        const completedInvestments = document.getElementById('completed-investments');
        
        // Inicialização
        document.addEventListener('DOMContentLoaded', () => {
            connectWalletBtn.addEventListener('click', connectWallet);
            disconnectBtn.addEventListener('click', disconnectWallet);
            investAmountInput.addEventListener('input', updateInvestmentDetails);
            investBtn.addEventListener('click', invest);
            
            // Verificar se já está conectado
            if (typeof window.ethereum !== 'undefined') {
                window.ethereum.request({ method: 'eth_accounts' })
                    .then(accounts => {
                        if (accounts.length > 0) {
                            connectWallet();
                        }
                    })
                    .catch(error => {
                        console.error('Erro ao verificar contas:', error);
                    });
            }
        });
        
        // Conectar carteira
        async function connectWallet() {
            if (typeof window.ethereum === 'undefined') {
                showNotification('MetaMask não está instalada. Por favor, instale para continuar.', 'error');
                return;
            }
            
            try {
                // Solicitar acesso à carteira
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                account = accounts[0];
                
                // Configurar provedor e signer
                provider = new ethers.providers.Web3Provider(window.ethereum);
                signer = provider.getSigner();
                
                // Configurar contratos
                contract = new ethers.Contract(contractAddress, contractABI, signer);
                usdtContract = new ethers.Contract(usdtAddress, usdtABI, signer);
                
                // Verificar rede
                const network = await provider.getNetwork();
                if (network.chainId !== 56) { // 56 é o ID da BSC Mainnet
                    showNotification('Por favor, conecte-se à rede Binance Smart Chain (BSC)', 'error');
                    return;
                }
                
                // Atualizar UI
                walletAddress.textContent = account;
                walletInfo.classList.remove('hidden');
                investSection.classList.remove('hidden');
                investmentsSection.classList.remove('hidden');
                connectWalletBtn.textContent = 'Carteira Conectada';
                connectWalletBtn.disabled = true;
                
                // Carregar dados
                loadUSDTBalance();
                loadInvestments();
                
                // Escutar eventos
                window.ethereum.on('accountsChanged', handleAccountsChanged);
                window.ethereum.on('chainChanged', handleChainChanged);
                
                showNotification('Carteira conectada com sucesso!', 'success');
            } catch (error) {
                console.error('Erro ao conectar carteira:', error);
                showNotification('Erro ao conectar carteira: ' + error.message, 'error');
            }
        }
        
        // Desconectar carteira
        function disconnectWallet() {
            // Não é possível desconectar programaticamente, apenas atualizar a UI
            walletInfo.classList.add('hidden');
            investSection.classList.add('hidden');
            investmentsSection.classList.add('hidden');
            connectWalletBtn.textContent = 'Conectar Carteira';
            connectWalletBtn.disabled = false;
            investments = [];
            investmentsList.innerHTML = '';
            showNotification('Carteira desconectada', 'info');
        }
        
        // Lidar com mudança de contas
        function handleAccountsChanged(accounts) {
            if (accounts.length === 0) {
                disconnectWallet();
            } else if (accounts[0] !== account) {
                account = accounts[0];
                walletAddress.textContent = account;
                loadUSDTBalance();
                loadInvestments();
            }
        }
        
        // Lidar com mudança de rede
        function handleChainChanged() {
            window.location.reload();
        }
        
        // Carregar saldo de USDT
        async function loadUSDTBalance() {
            try {
                const balance = await usdtContract.balanceOf(account);
                const formattedBalance = ethers.utils.formatUnits(balance, 18);
                usdtBalance.textContent = parseFloat(formattedBalance).toFixed(2) + ' USDT';
            } catch (error) {
                console.error('Erro ao carregar saldo de USDT:', error);
                usdtBalance.textContent = 'Erro ao carregar saldo';
            }
        }
        
        // Carregar investimentos
        async function loadInvestments() {
            try {
                const investmentCount = await contract.getInvestmentCount(account);
                const investmentData = await contract.getInvestments(account);
                
                investments = investmentData.map(inv => ({
                    id: inv.id.toString(),
                    investor: inv.investor,
                    principalAmount: ethers.utils.formatUnits(inv.principalAmount, 18),
                    originalAmount: ethers.utils.formatUnits(inv.originalAmount, 18),
                    timestamp: inv.timestamp.toNumber(),
                    withdrawn: inv.withdrawn
                }));
                
                updateInvestmentsList();
                updateStats();
            } catch (error) {
                console.error('Erro ao carregar investimentos:', error);
                showNotification('Erro ao carregar investimentos: ' + error.message, 'error');
            }
        }
        
        // Atualizar lista de investimentos
        function updateInvestmentsList() {
            investmentsList.innerHTML = '';
            
            if (investments.length === 0) {
                investmentsList.innerHTML = '<p>Você não possui investimentos ativos.</p>';
                return;
            }
            
            investments.forEach(investment => {
                const investmentItem = document.createElement('div');
                investmentItem.className = 'investment-item';
                
                const investmentDetails = document.createElement('div');
                investmentDetails.className = 'investment-details';
                
                const investmentId = document.createElement('div');
                investmentId.innerHTML = `<strong>ID:</strong> ${investment.id}`;
                
                const investmentAmount = document.createElement('div');
                investmentAmount.innerHTML = `<strong>Valor Investido:</strong> ${parseFloat(investment.originalAmount).toFixed(2)} USDT`;
                
                const investmentDate = document.createElement('div');
                const date = new Date(investment.timestamp * 1000);
                investmentDate.innerHTML = `<strong>Data:</strong> ${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;
                
                const investmentReturn = document.createElement('div');
                const returnAmount = parseFloat(investment.originalAmount) * 0.24; // 24% de retorno
                const totalAmount = parseFloat(investment.originalAmount) + returnAmount;
                investmentReturn.innerHTML = `<strong>Retorno Esperado:</strong> ${returnAmount.toFixed(2)} USDT (Total: ${totalAmount.toFixed(2)} USDT)`;
                
                investmentDetails.appendChild(investmentId);
                investmentDetails.appendChild(investmentAmount);
                investmentDetails.appendChild(investmentDate);
                investmentDetails.appendChild(investmentReturn);
                
                const investmentActions = document.createElement('div');
                
                if (investment.withdrawn) {
                    const statusBadge = document.createElement('div');
                    statusBadge.className = 'status-badge status-completed';
                    statusBadge.textContent = 'Concluído';
                    investmentActions.appendChild(statusBadge);
                } else {
                    const countdown = document.createElement('div');
                    countdown.className = 'countdown';
                    investmentActions.appendChild(countdown);
                    
                    const withdrawBtn = document.createElement('button');
                    withdrawBtn.className = 'btn btn-success';
                    withdrawBtn.textContent = 'Sacar';
                    withdrawBtn.disabled = true;
                    
                    const endTime = investment.timestamp + (28 * 24 * 60 * 60); // 28 dias em segundos
                    const currentTime = Math.floor(Date.now() / 1000);
                    
                    if (currentTime >= endTime) {
                        withdrawBtn.disabled = false;
                        withdrawBtn.addEventListener('click', () => withdraw(investment.id));
                        countdown.textContent = 'Pronto para saque!';
                    } else {
                        updateCountdown(countdown, endTime);
                        const interval = setInterval(() => {
                            if (updateCountdown(countdown, endTime)) {
                                clearInterval(interval);
                                withdrawBtn.disabled = false;
                                withdrawBtn.addEventListener('click', () => withdraw(investment.id));
                                countdown.textContent = 'Pronto para saque!';
                            }
                        }, 1000);
                    }
                    
                    investmentActions.appendChild(withdrawBtn);
                }
                
                investmentItem.appendChild(investmentDetails);
                investmentItem.appendChild(investmentActions);
                investmentsList.appendChild(investmentItem);
            });
        }
        
        // Atualizar contagem regressiva
        function updateCountdown(element, endTime) {
            const currentTime = Math.floor(Date.now() / 1000);
            const timeLeft = endTime - currentTime;
            
            if (timeLeft <= 0) {
                return true; // Tempo esgotado
            }
            
            const days = Math.floor(timeLeft / (60 * 60 * 24));
            const hours = Math.floor((timeLeft % (60 * 60 * 24)) / (60 * 60));
            const minutes = Math.floor((timeLeft % (60 * 60)) / 60);
            const seconds = timeLeft % 60;
            
            element.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s`;
            
            return false;
        }
        
        // Atualizar estatísticas
        function updateStats() {
            let totalInvestedValue = 0;
            let totalEarnedValue = 0;
            let activeCount = 0;
            let completedCount = 0;
            
            investments.forEach(investment => {
                totalInvestedValue += parseFloat(investment.originalAmount);
                
                if (investment.withdrawn) {
                    completedCount++;
                    const returnAmount = parseFloat(investment.originalAmount) * 0.24;
                    totalEarnedValue += returnAmount;
                } else {
                    activeCount++;
                }
            });
            
            totalInvested.textContent = totalInvestedValue.toFixed(2);
            totalEarned.textContent = totalEarnedValue.toFixed(2);
            activeInvestments.textContent = activeCount;
            completedInvestments.textContent = completedCount;
        }
        
        // Atualizar detalhes do investimento
        function updateInvestmentDetails() {
            const amount = parseFloat(investAmountInput.value) || 0;
            const fee = amount * 0.02; // 2% de taxa
            const principal = amount - fee;
            
            feeAmount.textContent = fee.toFixed(2) + ' USDT';
            principalAmount.textContent = principal.toFixed(2) + ' USDT';
        }
        
        // Investir
        async function invest() {
            const amount = parseFloat(investAmountInput.value);
            
            if (isNaN(amount) || amount <= 0) {
                showNotification('Por favor, insira um valor válido para o investimento', 'error');
                return;
            }
            
            // Converter para wei (considerando 18 casas decimais)
            const amountInWei = ethers.utils.parseUnits(amount.toString(), 18);
            
            try {
                // Verificar aprovação
                const allowance = await usdtContract.allowance(account, contractAddress);
                
                if (allowance.lt(amountInWei)) {
                    showNotification('Aprovando USDT para o contrato...', 'info');
                    
                    // Aprovar o contrato a gastar USDT
                    const approveTx = await usdtContract.approve(contractAddress, amountInWei);
                    await approveTx.wait();
                    
                    showNotification('USDT aprovado com sucesso!', 'success');
                }
                
                showNotification('Realizando investimento...', 'info');
                
                // Realizar investimento
                const investTx = await contract.invest(amountInWei);
                await investTx.wait();
                
                showNotification('Investimento realizado com sucesso!', 'success');
                
                // Limpar campo e atualizar dados
                investAmountInput.value = '';
                updateInvestmentDetails();
                loadUSDTBalance();
                loadInvestments();
            } catch (error) {
                console.error('Erro ao investir:', error);
                showNotification('Erro ao investir: ' + error.message, 'error');
            }
        }
        
        // Sacar
        async function withdraw(investmentId) {
            try {
                showNotification('Realizando saque...', 'info');
                
                // Converter ID para BigNumber
                const id = ethers.BigNumber.from(investmentId);
                
                // Realizar saque
                const withdrawTx = await contract.withdraw(id);
                await withdrawTx.wait();
                
                showNotification('Saque realizado com sucesso!', 'success');
                
                // Atualizar dados
                loadUSDTBalance();
                loadInvestments();
            } catch (error) {
                console.error('Erro ao sacar:', error);
                showNotification('Erro ao sacar: ' + error.message, 'error');
            }
        }
        
        // Mostrar notificação
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.getElementById('notification-container').appendChild(notification);
            
            // Remover notificação após 5 segundos
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 5000);
        }
    </script>
</body>
</html>
