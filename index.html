<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liquidity Pool Netlify - Investimento Inteligente</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.7.4/dist/web3.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #7e22ce;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #64748b;
            --card-bg: #ffffff;
            --header-gradient: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9;
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 50px 0;
            background: var(--header-gradient);
            color: white;
            border-radius: 16px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 60%);
            transform: rotate(30deg);
        }
        
        header h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            font-weight: 700;
            position: relative;
        }
        
        header p {
            font-size: 1.3rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }
        
        .card {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .section-title {
            font-size: 1.6rem;
            margin-bottom: 25px;
            color: var(--dark);
            padding-left: 15px;
            border-left: 5px solid var(--primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .btn {
            background: var(--header-gradient);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 1rem;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(37, 99, 235, 0.3);
        }
        
        .btn:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .btn-secondary {
            background: #e2e8f0;
            color: var(--dark);
        }
        
        .btn-secondary:hover {
            background: #cbd5e1;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark);
        }
        
        input, select {
            width: 100%;
            padding: 14px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .info-panel {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            border-left: 4px solid var(--primary);
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .info-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .info-label {
            font-weight: 500;
            color: var(--gray);
        }
        
        .info-value {
            font-weight: 600;
            color: var(--dark);
        }
        
        .notification {
            padding: 16px 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .notification.success {
            background-color: #ecfdf5;
            border: 1px solid #10b981;
            color: #047857;
        }
        
        .notification.error {
            background-color: #fef2f2;
            border: 1px solid #ef4444;
            color: #b91c1c;
        }
        
        .loading-spinner {
            border: 3px solid #e2e8f0;
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 35px;
        }
        
        .stat-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 8px;
        }
        
        .stat-label {
            color: var(--gray);
            font-size: 0.95rem;
        }
        
        .connect-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .wallet-info {
            display: flex;
            align-items: center;
        }
        
        .wallet-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--header-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin-right: 15px;
            font-size: 1.4rem;
        }
        
        .wallet-details p {
            margin-bottom: 5px;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .feature-item {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        
        .feature-icon {
            font-size: 2rem;
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .disclaimer {
            background: #fffbeb;
            border: 1px solid #fcd34d;
            border-radius: 12px;
            padding: 20px;
            margin-top: 30px;
            font-size: 0.9rem;
            color: #92400e;
        }
        
        @media (max-width: 768px) {
            .connect-section {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .action-buttons {
                flex-direction: column;
                width: 100%;
            }
            
            .btn {
                width: 100%;
            }
            
            header h1 {
                font-size: 2.2rem;
            }
            
            header p {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-chart-line"></i> Liquidity Pool Netlify</h1>
            <p>Invista com intelig√™ncia e receba retornos atrativos com nosso APY vari√°vel</p>
            <div class="contract-link">
                üîó<p><b><a href="https://bscscan.com/address/0xdce2abab940f1bf98a09981f60a1620ebc47af6e" target="_blank"><span style="color: white;">Ver contrato no BscScan</span></a></b></p>
            </div>
        </header>
        
        <div id="notification" class="notification" style="display: none;"></div>
        
        <div class="card">
            <h2 class="section-title"><i class="fas fa-wallet"></i> Minha Carteira</h2>
            <div class="connect-section">
                <div class="wallet-info">
                    <div class="wallet-icon">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="wallet-details">
                        <p><strong>Status:</strong> <span id="connection-status">N√£o conectado</span></p>
                        <p><strong>Endere√ßo:</strong> <span id="user-address">-</span></p>
                    </div>
                </div>
                <button id="connect-btn" class="btn">
                    <i class="fas fa-link"></i> Conectar Carteira
                </button>
            </div>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="total-pool">0</div>
                <div class="stat-label">Total Investido no Pool</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="current-apy">5.00%</div>
                <div class="stat-label">APY Atual</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="my-balance">0</div>
                <div class="stat-label">Meu Saldo</div>
            </div>
        </div>
        
        <div class="card">
            <h2 class="section-title"><i class="fas fa-plus-circle"></i> Investir</h2>
            <div class="form-group">
                <label for="deposit-amount">Quantidade de USDT:</label>
                <input type="number" id="deposit-amount" placeholder="Ex: 100" step="any">
            </div>
            <button id="deposit-btn" class="btn" disabled>
                <i class="fas fa-arrow-down"></i> Depositar
            </button>
        </div>
        
        <div class="card">
            <h2 class="section-title"><i class="fas fa-money-bill-wave"></i> Meus Ganhos</h2>
            <div class="info-panel">
                <div class="info-item">
                    <span class="info-label">Recompensas Acumuladas:</span>
                    <span class="info-value" id="accumulated-rewards">0 USDT</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Pr√≥ximo Saque Dispon√≠vel:</span>
                    <span class="info-value" id="next-withdrawal">-</span>
                </div>
            </div>
            <div class="action-buttons">
                <button id="claim-rewards-btn" class="btn" disabled>
                    <i class="fas fa-hand-holding-usd"></i> Reclamar Recompensas
                </button>
                <button id="withdraw-btn" class="btn" disabled>
                    <i class="fas fa-times-circle"></i> Sacar Total (Ap√≥s 30 dias)
                </button>
            </div>
        </div>
        
        <div class="card">
            <h2 class="section-title"><i class="fas fa-info-circle"></i> Como Funciona</h2>
            <div class="features-grid">
                <div class="feature-item">
                    <div class="feature-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <h3>Seguro e Transparente</h3>
                    <p>Todo o investimento √© feito via blockchain, sem intermedi√°rios.</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3>APY Vari√°vel</h3>
                    <p>Quanto mais investidores, maior o retorno em APY.</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <h3>Saques Mensais</h3>
                    <p>Seu investimento + recompensas ficam bloqueados por 30 dias.</p>
                </div>
                <div class="feature-item">
                    <div class="feature-icon">
                        <i class="fas fa-expand-arrows-alt"></i>
                    </div>
                    <h3>Baseado em Volume</h3>
                    <p>O APY aumenta proporcionalmente ao tamanho do pool.</p>
                </div>
            </div>
        </div>
        
        <div class="disclaimer">
            <h3><i class="fas fa-exclamation-circle"></i> Informa√ß√µes Importantes</h3>
            <p>Investimentos em criptomoedas envolvem riscos. Os valores dos lucros do seu investimento podem flutuar e n√£o √© garantido.</p>
        </div>
    </div>

    <script>
        // Configura√ß√£o do contrato
        const contractABI = [
            {
                "inputs": [],
                "stateMutability": "nonpayable",
                "type": "constructor",
                "inputs": [{ "internalType": "contract.IERC20", "name": "_usdtToken", "type": "address" }]
            },
            {
                "anonymous": false,
                "inputs": [{ "indexed": true, "internalType": "address", "name": "user", "type": "address" }, { "indexed": false, "internalType": "uint256", "name": "amount", "type": "uint256" }],
                "name": "Deposited",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [{ "indexed": true, "internalType": "address", "name": "user", "type": "address" }, { "indexed": false, "internalType": "uint256", "name": "amount", "type": "uint256" }],
                "name": "Withdrawn",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [{ "indexed": true, "internalType": "address", "name": "user", "type": "address" }, { "indexed": false, "internalType": "uint256", "name": "amount", "type": "uint256" }],
                "name": "RewardsClaimed",
                "type": "event"
            },
            {
                "inputs": [{ "internalType": "uint256", "name": "amount", "type": "uint256" }],
                "name": "deposit",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "calculateDailyRewards",
                "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "claimRewards",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "withdraw",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "totalInvested",
                "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "baseAPY",
                "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }],
                "stateMutability": "view",
                "type": "function"
            }
        ];
        
        const contractAddress = '0xdCE2abAb940f1BF98a09981F60A1620eBc47aF6E';
        let web3;
        let contract;
        let connectedAccount;
        
        // Fun√ß√£o para mostrar notifica√ß√£o
        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i> ${message}`;
            notification.className = `notification ${type}`;
            notification.style.display = 'flex';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 5000);
        }
        
        // Fun√ß√£o para conectar √† carteira
        async function connectWallet() {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    connectedAccount = accounts[0];
                    
                    web3 = new Web3(window.ethereum);
                    contract = new web3.eth.Contract(contractABI, contractAddress);
                    
                    document.getElementById('user-address').textContent = `${connectedAccount.substring(0, 6)}...${connectedAccount.substring(connectedAccount.length - 4)}`;
                    document.getElementById('connection-status').textContent = 'Conectado';
                    document.getElementById('connect-btn').innerHTML = '<i class="fas fa-sign-out-alt"></i> Desconectar';
                    
                    // Habilitar bot√µes
                    document.getElementById('deposit-btn').disabled = false;
                    document.getElementById('claim-rewards-btn').disabled = false;
                    document.getElementById('withdraw-btn').disabled = false;
                    
                    // Carregar dados do usu√°rio
                    loadUserData();
                    loadPoolData();
                    
                    showNotification('Carteira conectada com sucesso!', 'success');
                    
                    // Verificar aprova√ß√£o de USDT
                    await checkAllowance();
                } catch (error) {
                    showNotification('Erro ao conectar carteira: ' + error.message, 'error');
                }
            } else {
                showNotification('Por favor instale MetaMask ou outra carteira compat√≠vel com BSC', 'error');
            }
        }
        
        // Fun√ß√£o para verificar aprova√ß√£o de USDT
        async function checkAllowance() {
            try {
                const usdtTokenAddress = '0x55d398326f99059fF775485246999027B3197955'; // USDT BSC mainnet
                const usdtContract = new web3.eth.Contract([
                    {
                        "constant": true,
                        "inputs": [
                            {"name":"_owner","type":"address"},
                            {"name":"_spender","type":"address"}
                        ],
                        "name": "allowance",
                        "outputs": [{"name":"","type":"uint256"}],
                        "type": "function"
                    }
                ], usdtTokenAddress);
                
                const allowance = await usdtContract.methods.allowance(connectedAccount, contractAddress).call();
                const allowanceInUsdt = web3.utils.fromWei(allowance, 'ether');
                
                console.log('Allowance:', allowanceInUsdt, 'USDT');
            } catch (error) {
                console.error('Erro ao verificar allowance:', error);
            }
        }
        
        // Fun√ß√£o para aprovar USDT
        async function approveUSDT(amount) {
            try {
                const usdtTokenAddress = '0x55d398326f99059fF775485246999027B3197955'; // USDT BSC mainnet
                const amountInWei = web3.utils.toWei(amount.toString(), 'ether');
                
                const usdtContract = new web3.eth.Contract([
                    {
                        "constant": false,
                        "inputs": [
                            {"name":"_spender","type":"address"},
                            {"name":"_value","type":"uint256"}
                        ],
                        "name": "approve",
                        "outputs": [{"name":"","type":"bool"}],
                        "type": "function"
                    }
                ], usdtTokenAddress);
                
                await usdtContract.methods.approve(contractAddress, amountInWei)
                    .send({ from: connectedAccount });
                
                showNotification('Aprova√ß√£o de USDT realizada com sucesso!', 'success');
                return true;
            } catch (error) {
                showNotification('Erro na aprova√ß√£o de USDT: ' + error.message, 'error');
                return false;
            }
        }
        
        // Fun√ß√£o para desconectar carteira
        function disconnectWallet() {
            connectedAccount = null;
            web3 = null;
            contract = null;
            
            document.getElementById('user-address').textContent = '-';
            document.getElementById('connection-status').textContent = 'N√£o conectado';
            document.getElementById('connect-btn').innerHTML = '<i class="fas fa-link"></i> Conectar Carteira';
            
            // Desabilitar bot√µes
            document.getElementById('deposit-btn').disabled = true;
            document.getElementById('claim-rewards-btn').disabled = true;
            document.getElementById('withdraw-btn').disabled = true;
            
            // Resetar informa√ß√µes
            document.getElementById('total-pool').textContent = '0';
            document.getElementById('current-apy').textContent = '5.00%';
            document.getElementById('my-balance').textContent = '0';
            document.getElementById('accumulated-rewards').textContent = '0 USDT';
            document.getElementById('next-withdrawal').textContent = '-';
            
            showNotification('Carteira desconectada', 'success');
        }
        
        // Fun√ß√£o para carregar dados do usu√°rio
        async function loadUserData() {
            if (!contract || !connectedAccount) return;
            
            try {
                // Carregar saldo do usu√°rio
                const userInfo = await contract.methods.users(connectedAccount).call();
                document.getElementById('my-balance').textContent = web3.utils.fromWei(userInfo.investedAmount, 'ether');
                
                // Calcular recompensas acumuladas
                const timeElapsed = Math.floor((Date.now() / 1000) - userInfo.lastWithdrawalTime);
                const daysElapsed = Math.floor(timeElapsed / (24 * 60 * 60));
                
                let accumulatedRewards = 0;
                for (let i = 0; i < daysElapsed; i++) {
                    accumulatedRewards += await contract.methods.calculateDailyRewards().call({ from: connectedAccount });
                }
                
                document.getElementById('accumulated-rewards').textContent = 
                    `${web3.utils.fromWei(accumulatedRewards, 'ether')} USDT`;
                
                // Calcular pr√≥ximo saque
                if (userInfo.lastWithdrawalTime === 0) {
                    document.getElementById('next-withdrawal').textContent = 'Nenhum dep√≥sito realizado';
                } else if (daysElapsed >= 30) {
                    document.getElementById('next-withdrawal').textContent = 'Dispon√≠vel agora';
                    document.getElementById('withdraw-btn').disabled = false;
                } else {
                    const nextWithdrawal = new Date(userInfo.lastWithdrawalTime * 1000);
                    nextWithdrawal.setDate(nextWithdrawal.getDate() + 30);
                    const daysLeft = Math.ceil((nextWithdrawal.getTime() - Date.now()) / (1000 * 60 * 60 * 24));
                    document.getElementById('next-withdrawal').textContent = 
                        `Dispon√≠vel em ${daysLeft} dias`;
                    document.getElementById('withdraw-btn').disabled = daysLeft > 0;
                }
            } catch (error) {
                console.error('Erro ao carregar dados do usu√°rio:', error);
            }
        }
        
        // Fun√ß√£o para carregar dados do pool
        async function loadPoolData() {
            if (!contract) return;
            
            try {
                const totalInvested = await contract.methods.totalInvested().call();
                document.getElementById('total-pool').textContent = 
                    `${web3.utils.fromWei(totalInvested, 'ether')} USDT`;
                
                const baseAPY = await contract.methods.baseAPY().call();
                const currentAPY = baseAPY / 10000; // Convertendo de baseAPY para percentual
                document.getElementById('current-apy').textContent = 
                    `${currentAPY.toFixed(2)}%`;
            } catch (error) {
                console.error('Erro ao carregar dados do pool:', error);
            }
        }
        
        // Fun√ß√£o para depositar
        async function deposit() {
            if (!contract || !connectedAccount) return;
            
            const amount = document.getElementById('deposit-amount').value;
            if (!amount || parseFloat(amount) <= 0) {
                showNotification('Por favor insira um valor v√°lido', 'error');
                return;
            }
            
            try {
                document.getElementById('deposit-btn').innerHTML = '<span class="loading-spinner"></span> Processando...';
                document.getElementById('deposit-btn').disabled = true;
                
                // Primeiro aprovar o gasto de USDT
                const approved = await approveUSDT(amount);
                if (!approved) {
                    throw new Error('Falha na aprova√ß√£o de USDT');
                }
                
                // Depois depositar
                await contract.methods.deposit(
                    web3.utils.toWei(amount, 'ether')
                ).send({ from: connectedAccount, gas: 300000 });
                
                showNotification('Dep√≥sito realizado com sucesso!', 'success');
                document.getElementById('deposit-amount').value = '';
                loadUserData();
                loadPoolData();
            } catch (error) {
                showNotification('Erro ao realizar dep√≥sito: ' + error.message, 'error');
            } finally {
                document.getElementById('deposit-btn').innerHTML = '<i class="fas fa-arrow-down"></i> Depositar';
                document.getElementById('deposit-btn').disabled = false;
            }
        }
        
        // Fun√ß√£o para reclamar recompensas
        async function claimRewards() {
            if (!contract || !connectedAccount) return;
            
            try {
                document.getElementById('claim-rewards-btn').innerHTML = '<span class="loading-spinner"></span> Processando...';
                document.getElementById('claim-rewards-btn').disabled = true;
                
                await contract.methods.claimRewards().send({ from: connectedAccount, gas: 300000 });
                
                showNotification('Recompensas reclamadas com sucesso!', 'success');
                loadUserData();
            } catch (error) {
                showNotification('Erro ao reclamar recompensas: ' + error.message, 'error');
            } finally {
                document.getElementById('claim-rewards-btn').innerHTML = '<i class="fas fa-hand-holding-usd"></i> Reclamar Recompensas';
                document.getElementById('claim-rewards-btn').disabled = false;
            }
        }
        
        // Fun√ß√£o para sacar tudo
        async function withdrawAll() {
            if (!contract || !connectedAccount) return;
            
            try {
                document.getElementById('withdraw-btn').innerHTML = '<span class="loading-spinner"></span> Processando...';
                document.getElementById('withdraw-btn').disabled = true;
                
                await contract.methods.withdraw().send({ from: connectedAccount, gas: 300000 });
                
                showNotification('Saque realizado com sucesso!', 'success');
                loadUserData();
            } catch (error) {
                showNotification('Erro ao realizar saque: ' + error.message, 'error');
            } finally {
                document.getElementById('withdraw-btn').innerHTML = '<i class="fas fa-times-circle"></i> Sacar Total (Ap√≥s 30 dias)';
                document.getElementById('withdraw-btn').disabled = false;
            }
        }
        
        // Event listeners
        document.getElementById('connect-btn').addEventListener('click', () => {
            if (connectedAccount) {
                disconnectWallet();
            } else {
                connectWallet();
            }
        });
        
        document.getElementById('deposit-btn').addEventListener('click', deposit);
        document.getElementById('claim-rewards-btn').addEventListener('click', claimRewards);
        document.getElementById('withdraw-btn').addEventListener('click', withdrawAll);
        
        // Carregar dados iniciais quando a p√°gina carregar
        window.addEventListener('load', () => {
            loadPoolData();
            
            // Verificar se MetaMask est√° instalado
            if (typeof window.ethereum !== 'undefined') {
                console.log('MetaMask est√° instalado!');
            } else {
                showNotification('Instale o MetaMask para usar esta aplica√ß√£o', 'error');
            }
        });
    </script>
</body>
</html>
