<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POL Price Proxy - Controle de Preço</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .container { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        button { background: #8247e5; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; }
        input { padding: 8px; margin: 5px 0; width: 100%; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Controle de Preço do POL</h1>
        
        <!-- Seção de Conexão -->
        <div>
            <h2>1. Conectar Carteira</h2>
            <button id="connectWallet">Conectar MetaMask</button>
            <p id="walletAddress" style="display: none;"></p>
        </div>

        <!-- Seção de Preço -->
        <div>
            <h2>2. Definir Preço Exibido</h2>
            <input type="number" id="customPrice" placeholder="Preço personalizado (ex: 312000)" value="312000">
            <button id="setPrice">Atualizar Preço na Página</button>
            <p>Preço atual: <span id="displayedPrice">0</span> USDC/POL</p>
        </div>

        <!-- Seção de Swap Simulado -->
        <div>
            <h2>3. Troca Simulada (apenas visual)</h2>
            <input type="number" id="polAmount" placeholder="Quantidade de POL">
            <button id="simulateSwap">Calcular USDC</button>
            <p>Você receberá: <span id="usdcAmount">0</span> USDC (simulação)</p>
        </div>
    </div>

    <script>
        // ABI do seu contrato implantado (0x6Cc8B4a08be3D8e0C7Ef0F4C9eF1cD336f6DDc4d)
        const contractABI = [
            {"inputs":[],"stateMutability":"nonpayable","type":"constructor"},
            {"inputs":[],"name":"FIXED_PRICE","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"POL_TOKEN","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"QUICKSWAP_ROUTER","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[],"name":"USDC_TOKEN","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"priceOverrideActive","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},
            {"inputs":[{"internalType":"uint256","name":"amountPOL","type":"uint256"}],"name":"swapPOLForUSDC","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"inputs":[],"name":"togglePriceOverride","outputs":[],"stateMutability":"nonpayable","type":"function"},
            {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"amountIn","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"amountOut","type":"uint256"}],"name":"SwapExecuted","type":"event"}
        ];

        // Configurações
        const contractAddress = "0x6Cc8B4a08be3D8e0C7Ef0F4C9eF1cD336f6DDc4d"; // SEU CONTRATO
        let web3;
        let contract;
        let accounts = [];

        // Inicialização
        window.addEventListener('load', async () => {
            // Conectar MetaMask
            document.getElementById('connectWallet').addEventListener('click', connectWallet);
            
            // Botões de controle
            document.getElementById('setPrice').addEventListener('click', updateDisplayedPrice);
            document.getElementById('simulateSwap').addEventListener('click', simulateSwap);
            
            if (window.ethereum) {
                web3 = new Web3(window.ethereum);
                try {
                    accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    contract = new web3.eth.Contract(contractABI, contractAddress);
                    updateUI();
                } catch (error) {
                    console.error("Erro ao conectar:", error);
                }
            }
        });

        // Funções principais
        async function connectWallet() {
            accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
            document.getElementById('walletAddress').textContent = `Conectado: ${accounts[0]}`;
            document.getElementById('walletAddress').style.display = "block";
            contract = new web3.eth.Contract(contractABI, contractAddress);
        }

        function updateDisplayedPrice() {
            const customPrice = document.getElementById('customPrice').value;
            document.getElementById('displayedPrice').textContent = customPrice;
        }

        function simulateSwap() {
            const polAmount = parseFloat(document.getElementById('polAmount').value);
            const customPrice = parseFloat(document.getElementById('customPrice').value);
            if (!isNaN(polAmount) {
                document.getElementById('usdcAmount').textContent = (polAmount * customPrice).toFixed(2);
            }
        }

        function updateUI() {
            // Atualizações visuais podem ser adicionadas aqui
        }
    </script>
</body>
</html>
